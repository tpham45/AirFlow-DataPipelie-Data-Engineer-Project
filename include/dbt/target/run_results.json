{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.7", "generated_at": "2024-02-08T00:00:00.197686Z", "invocation_id": "357b86c0-5e3c-4010-b429-60720e5b7efc", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:30.194159Z", "completed_at": "2024-02-07T23:59:30.206894Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:30.209092Z", "completed_at": "2024-02-07T23:59:33.400699Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.2105603218078613, "adapter_response": {"_message": "CREATE TABLE (100.0k rows, 9.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 99995, "bytes_processed": 9599520, "bytes_billed": 10485760, "location": "US", "project_id": "taxi-project-412919", "job_id": "0e550590-b57c-4c56-8ac4-4c55636d1fec", "slot_ms": 12868}, "message": "CREATE TABLE (100.0k rows, 9.2 MiB processed)", "failures": null, "unique_id": "model.taxi_data.dim_datetime", "compiled": true, "compiled_code": "--Create dim_datetime table\n    select \n        datetimeindex_id,\n        pick_datetime,\n        pick_day,\n        pick_month,\n        pick_year,\n        pick_weekday,\n        drop_datetime,\n        drop_hour,\n        drop_day,\n        drop_month,\n        drop_year,\n        drop_weekday\n    from\n        `taxi-project-412919`.`taxi_data`.`taxi_metadata`", "relation_name": "`taxi-project-412919`.`taxi_data`.`dim_datetime`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:33.410892Z", "completed_at": "2024-02-07T23:59:33.419566Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:33.421866Z", "completed_at": "2024-02-07T23:59:36.322754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.916072368621826, "adapter_response": {"_message": "CREATE TABLE (100.0k rows, 2.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 99995, "bytes_processed": 2399880, "bytes_billed": 10485760, "location": "US", "project_id": "taxi-project-412919", "job_id": "174714f5-ab19-482f-a357-ad6317160bb7", "slot_ms": 3442}, "message": "CREATE TABLE (100.0k rows, 2.3 MiB processed)", "failures": null, "unique_id": "model.taxi_data.dim_locaiton", "compiled": true, "compiled_code": "--Create dim_location table\n    select \n        locationindex_id,\n        PUlocationCode,\n        DOlocationCode\n    from\n        `taxi-project-412919`.`taxi_data`.`taxi_metadata`", "relation_name": "`taxi-project-412919`.`taxi_data`.`dim_locaiton`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:36.333893Z", "completed_at": "2024-02-07T23:59:36.341973Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:36.343635Z", "completed_at": "2024-02-07T23:59:39.362022Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.0324511528015137, "adapter_response": {"_message": "CREATE TABLE (100.0k rows, 2.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 99995, "bytes_processed": 2784086, "bytes_billed": 10485760, "location": "US", "project_id": "taxi-project-412919", "job_id": "2942b8e2-40e3-4f89-93a7-6a6df2b2e6ba", "slot_ms": 3349}, "message": "CREATE TABLE (100.0k rows, 2.7 MiB processed)", "failures": null, "unique_id": "model.taxi_data.dim_payment_type", "compiled": true, "compiled_code": "--Create dim_paymenttype table\n    select \n        payment_typeindex_id,\n        payment_type_id,\n        payment_type_name\n    from\n        `taxi-project-412919`.`taxi_data`.`taxi_metadata`", "relation_name": "`taxi-project-412919`.`taxi_data`.`dim_payment_type`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:39.372569Z", "completed_at": "2024-02-07T23:59:39.382335Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:39.384361Z", "completed_at": "2024-02-07T23:59:42.112385Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.743809223175049, "adapter_response": {"_message": "CREATE TABLE (100.0k rows, 2.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 99995, "bytes_processed": 3051368, "bytes_billed": 10485760, "location": "US", "project_id": "taxi-project-412919", "job_id": "243fcc80-ea8b-4a3a-87f9-c81c2227509d", "slot_ms": 4007}, "message": "CREATE TABLE (100.0k rows, 2.9 MiB processed)", "failures": null, "unique_id": "model.taxi_data.dim_ratecode", "compiled": true, "compiled_code": "--Create dim_ratecode table\n    select \n        ratecodeIndex_id,\n        ratecode_id,\n        ratecode_name\n    from\n        `taxi-project-412919`.`taxi_data`.`taxi_metadata`", "relation_name": "`taxi-project-412919`.`taxi_data`.`dim_ratecode`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:42.122634Z", "completed_at": "2024-02-07T23:59:42.132501Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:42.134699Z", "completed_at": "2024-02-07T23:59:45.199424Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.0814292430877686, "adapter_response": {"_message": "CREATE TABLE (100.0k rows, 3.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 99995, "bytes_processed": 4096591, "bytes_billed": 10485760, "location": "US", "project_id": "taxi-project-412919", "job_id": "548d4a38-1772-4552-8c5e-1435a636a980", "slot_ms": 3629}, "message": "CREATE TABLE (100.0k rows, 3.9 MiB processed)", "failures": null, "unique_id": "model.taxi_data.dim_store_and_fwd_flag", "compiled": true, "compiled_code": "--Create dim_store_and_fwd_flag table\n    select \n        store_and_fwd_flag_index_id,\n        store_and_fwd_flag_id,\n        store_and_fwd_flag_type\n    from\n        `taxi-project-412919`.`taxi_data`.`taxi_metadata`", "relation_name": "`taxi-project-412919`.`taxi_data`.`dim_store_and_fwd_flag`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:45.210481Z", "completed_at": "2024-02-07T23:59:45.219238Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:45.220913Z", "completed_at": "2024-02-07T23:59:48.205501Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.998944044113159, "adapter_response": {"_message": "CREATE TABLE (100.0k rows, 3.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 99995, "bytes_processed": 3497930, "bytes_billed": 10485760, "location": "US", "project_id": "taxi-project-412919", "job_id": "fd3784e4-de2e-4776-a393-5d8304ad6cb6", "slot_ms": 4151}, "message": "CREATE TABLE (100.0k rows, 3.3 MiB processed)", "failures": null, "unique_id": "model.taxi_data.dim_vendor", "compiled": true, "compiled_code": "--Create dim_vendo table\n    select \n        vendorindex_id,\n        vendor_id,\n        vendor_type\n    from\n        `taxi-project-412919`.`taxi_data`.`taxi_metadata`", "relation_name": "`taxi-project-412919`.`taxi_data`.`dim_vendor`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:48.214472Z", "completed_at": "2024-02-07T23:59:48.222482Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:48.224595Z", "completed_at": "2024-02-07T23:59:51.390280Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.1796932220458984, "adapter_response": {"_message": "CREATE TABLE (100.0k rows, 13.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 99995, "bytes_processed": 14399280, "bytes_billed": 14680064, "location": "US", "project_id": "taxi-project-412919", "job_id": "bc67456c-3beb-494c-b71b-5f160c827141", "slot_ms": 5962}, "message": "CREATE TABLE (100.0k rows, 13.7 MiB processed)", "failures": null, "unique_id": "model.taxi_data.fact_trip", "compiled": true, "compiled_code": "--Create fact_trip table\n    select \n        trip_id,\n        vendorindex_id,\n        datetimeindex_id,\n        locationindex_id,\n        ratecodeindex_id,\n        payment_typeindex_id,\n        store_and_fwd_flag_index_id,\n        passenger_count,\n        trip_distance,\n        fare_amount,\n        extra,\n        mta_tax, \n        tip_amount,\n        tolls_amount,\n        improvement_surcharge,\n        congestion_surcharge,\n        Airport_fee,\n        total_amount\n    from\n        `taxi-project-412919`.`taxi_data`.`taxi_metadata`", "relation_name": "`taxi-project-412919`.`taxi_data`.`fact_trip`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:51.402216Z", "completed_at": "2024-02-07T23:59:51.411457Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:51.413292Z", "completed_at": "2024-02-07T23:59:54.462963Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.065199851989746, "adapter_response": {"_message": "CREATE TABLE (24.0 rows, 3.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 24, "bytes_processed": 3999800, "bytes_billed": 20971520, "location": "US", "project_id": "taxi-project-412919", "job_id": "deb788d1-11e5-4697-a4ab-a49a63489ade", "slot_ms": 722}, "message": "CREATE TABLE (24.0 rows, 3.8 MiB processed)", "failures": null, "unique_id": "model.taxi_data.report_rev_perhr", "compiled": true, "compiled_code": "with time_convert as (\n    select \n        d.datetimeindex_id,\n        cast(d.pick_datetime as timestamp) as pickup_timestamp,\n        cast(d.drop_datetime as timestamp) as dropoff_timestamp,\n        -- Extract the hour from the pickup timestamp\n        extract(hour from cast(d.pick_datetime as timestamp)) as pickup_hour\n    from `taxi-project-412919`.`taxi_data`.`dim_datetime` d\n    join `taxi-project-412919`.`taxi_data`.`fact_trip` f \n        on d.datetimeindex_id = f.datetimeindex_id\n),\nfact_trip_cte as (\n    select  \n        extract(hour from t.pickup_timestamp) as pickup_hour,\n        count(ft.trip_id) as total_trip,\n        sum(ft.total_amount) as total_revenue\n    from time_convert t\n    join  `taxi-project-412919`.`taxi_data`.`fact_trip` ft\n    on t.datetimeindex_id = ft.datetimeindex_id\n    group by pickup_hour\n)\nselect \n    fc.pickup_hour,\n    case when fc.total_trip > 0 then fc.total_revenue / fc.total_trip else 0 end as revenue_per_hour\nfrom fact_trip_cte fc\norder by fc.pickup_hour", "relation_name": "`taxi-project-412919`.`taxi_data`.`report_rev_perhr`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:54.472820Z", "completed_at": "2024-02-07T23:59:54.481822Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:54.484602Z", "completed_at": "2024-02-07T23:59:57.109621Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.6409459114074707, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 1.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 1599920, "bytes_billed": 10485760, "location": "US", "project_id": "taxi-project-412919", "job_id": "f9e8f9f4-1e75-4083-8170-f3154cbd5ae6", "slot_ms": 340}, "message": "CREATE TABLE (1.0 rows, 1.5 MiB processed)", "failures": null, "unique_id": "model.taxi_data.report_rev_pertrip", "compiled": true, "compiled_code": "with total_fact_trip as (\n    select  \n        count(f.trip_id) as total_trip,\n        sum(f.total_amount) as total_revenue\n    from `taxi-project-412919`.`taxi_data`.`fact_trip` f\n)\n\nselect \n    (t.total_revenue / nullif(t.total_trip, 0)) as revenue_per_trip\nfrom total_fact_trip t", "relation_name": "`taxi-project-412919`.`taxi_data`.`report_rev_pertrip`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-07T23:59:57.120565Z", "completed_at": "2024-02-07T23:59:57.130724Z"}, {"name": "execute", "started_at": "2024-02-07T23:59:57.133007Z", "completed_at": "2024-02-08T00:00:00.185386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.068883180618286, "adapter_response": {"_message": "CREATE TABLE (24.0 rows, 2.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 24, "bytes_processed": 2399880, "bytes_billed": 20971520, "location": "US", "project_id": "taxi-project-412919", "job_id": "212b6a77-1308-4f7a-8616-1c80044ec7ed", "slot_ms": 393}, "message": "CREATE TABLE (24.0 rows, 2.3 MiB processed)", "failures": null, "unique_id": "model.taxi_data.report_trip_perhr", "compiled": true, "compiled_code": "with time_convert as (\n    select \n        d.datetimeindex_id,\n        cast(d.pick_datetime as timestamp) as pickup_timestamp,\n        cast(d.drop_datetime as timestamp) as dropoff_timestamp,\n        -- Extract the hour from the pickup timestamp\n        extract(hour from cast(d.pick_datetime as timestamp)) as pickup_hour\n    from `taxi-project-412919`.`taxi_data`.`dim_datetime` d\n    join `taxi-project-412919`.`taxi_data`.`fact_trip` f \n        on d.datetimeindex_id = f.datetimeindex_id\n)\n\nselect\n    t.pickup_hour,\n    count(t.datetimeindex_id) as trips_per_hour\nfrom time_convert t\ngroup by t.pickup_hour\norder by t.pickup_hour", "relation_name": "`taxi-project-412919`.`taxi_data`.`report_trip_perhr`"}], "elapsed_time": 30.639861822128296, "args": {"write_json": true, "profiles_dir": "/usr/local/airflow/include/dbt", "log_format_file": "debug", "static_parser": true, "select": [], "partial_parse_file_diff": true, "favor_state": false, "defer": false, "send_anonymous_usage_stats": true, "use_colors_file": true, "quiet": false, "version_check": true, "show_resource_report": false, "invocation_command": "dbt run --profiles-dir /usr/local/airflow/include/dbt", "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "log_format": "default", "project_dir": "/usr/local/airflow/include/dbt", "partial_parse": true, "indirect_selection": "eager", "populate_cache": true, "macro_debugging": false, "strict_mode": false, "log_level": "info", "exclude": [], "use_colors": true, "printer_width": 80, "enable_legacy_logger": false, "print": true, "which": "run", "cache_selected_only": false, "vars": {}, "log_file_max_bytes": 10485760, "log_path": "/usr/local/airflow/include/dbt/logs"}}